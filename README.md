

The code is pretty messy because it was intended for one-time use. You should be able to run it end-to-end with minor modifications though.